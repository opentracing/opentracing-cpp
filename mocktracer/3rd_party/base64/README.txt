Modiefied from Envoy (https://github.com/envoyproxy/envoy).

commit d70404f7e5c89ab2c5fab72b516e2bf601969557
